# إصلاح صلاحيات تعديل الموظفين

## المشكلة
المدراء لا يستطيعون تعديل صلاحيات الموظفين أو معلوماتهم بسبب قيود RLS (Row Level Security).

## الحل
تطبيق migration جديد يضيف صلاحيات للمدراء لتعديل/إضافة/حذف ملفات الموظفين.

## كيفية التطبيق

### الطريقة 1: Supabase Dashboard (الأسهل)

1. افتح Supabase Dashboard
2. اذهب إلى **SQL Editor**
3. انسخ محتوى ملف `20240103_fix_profiles_permissions.sql`
4. الصقه في SQL Editor
5. اضغط **Run**

### الطريقة 2: Supabase CLI

```bash
supabase db push
```

## ما الذي يفعله هذا الـ Migration؟

يضيف 3 صلاحيات جديدة لجدول `profiles`:

1. **تحديث**: المدراء يمكنهم تحديث أي ملف موظف
2. **إضافة**: المدراء يمكنهم إضافة موظفين جدد
3. **حذف**: المدراء يمكنهم حذف موظفين

## التحقق من نجاح التطبيق

بعد تطبيق الـ migration:

1. سجل دخول كمدير
2. اذهب إلى صفحة "إدارة الموظفين"
3. حاول تعديل صلاحية موظف
4. يجب أن يتم التحديث بنجاح

## ملاحظات

- هذه الصلاحيات تعمل فقط للمستخدمين الذين لديهم `role = 'manager'`
- الموظفون العاديون لا يزالون يمكنهم تحديث ملفاتهم الشخصية فقط
- تأكد من تطبيق migration `20240101_init.sql` أولاً
